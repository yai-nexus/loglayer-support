# LogLayer v0.6.0-beta.1 æ–°åŠŸèƒ½æŒ‡å—

v0.6.0-beta.1 æ˜¯ä¸€ä¸ªé‡è¦çš„ Beta ç‰ˆæœ¬ï¼Œå¼•å…¥äº†ä¸‰å¤§æ ¸å¿ƒåŠŸèƒ½å¢å¼ºï¼Œæ˜¾è‘—æå‡äº†æ—¥å¿—ç³»ç»Ÿçš„å¯é æ€§ã€æ€§èƒ½å’Œå¼€å‘ä½“éªŒã€‚

## ğŸ¯ æ ¸å¿ƒæ–°åŠŸèƒ½

### 1. ğŸ›¡ï¸ ç»Ÿä¸€é”™è¯¯å¤„ç†ç³»ç»Ÿ

å…¨æ–°çš„é”™è¯¯å¤„ç†ç³»ç»Ÿæä¾›æ™ºèƒ½é”™è¯¯åˆ†ç±»ã€è‡ªåŠ¨æ¢å¤ç­–ç•¥å’Œè¯¦ç»†çš„é”™è¯¯ç»Ÿè®¡ã€‚

#### ç‰¹æ€§äº®ç‚¹

- **æ™ºèƒ½é”™è¯¯æ¨æ–­**: è‡ªåŠ¨è¯†åˆ«ç½‘ç»œã€éªŒè¯ã€é…ç½®ç­‰é”™è¯¯ç±»å‹
- **æ ‡å‡†åŒ–é”™è¯¯ç **: E1000-E6999 ç³»ç»ŸåŒ–é”™è¯¯ç¼–ç 
- **è‡ªåŠ¨æ¢å¤ç­–ç•¥**: é‡è¯•ã€é™çº§ã€å¿½ç•¥ã€åœæ­¢å››ç§ç­–ç•¥
- **é”™è¯¯ç»Ÿè®¡**: å®Œæ•´çš„é”™è¯¯è·Ÿè¸ªå’Œåˆ†æ

#### ä½¿ç”¨ç¤ºä¾‹

```typescript
import { createBrowserLogger, globalErrorHandler } from 'loglayer'

// è‡ªåŠ¨é”™è¯¯å¤„ç†
const logger = await createBrowserLogger({
  errorHandling: {
    captureGlobalErrors: true,
    captureUnhandledRejections: true
  }
})

// æ‰‹åŠ¨é”™è¯¯å¤„ç†
try {
  await riskyOperation()
} catch (error) {
  // è‡ªåŠ¨åˆ†ç±»å’Œå¤„ç†
  const handledError = await globalErrorHandler.handle(error, {
    context: 'user-action',
    userId: '12345'
  })
  
  console.log('é”™è¯¯ç :', handledError.code)
  console.log('é”™è¯¯ç±»åˆ«:', handledError.category)
  console.log('æ¢å¤ç­–ç•¥:', handledError.recovery)
}

// è·å–é”™è¯¯ç»Ÿè®¡
const stats = globalErrorHandler.getStats()
console.log('æ´»è·ƒé‡è¯•:', stats.activeRetries)
console.log('æ€»é‡è¯•æ¬¡æ•°:', stats.totalRetries)
```

#### é”™è¯¯åˆ†ç±»ä½“ç³»

```typescript
enum ErrorCategory {
  CONFIGURATION = 'configuration',  // é…ç½®é”™è¯¯
  NETWORK = 'network',              // ç½‘ç»œé”™è¯¯
  VALIDATION = 'validation',        // éªŒè¯é”™è¯¯
  PERMISSION = 'permission',        // æƒé™é”™è¯¯
  SYSTEM = 'system',               // ç³»ç»Ÿé”™è¯¯
  UNKNOWN = 'unknown'              // æœªçŸ¥é”™è¯¯
}

enum RecoveryStrategy {
  RETRY = 'retry',        // é‡è¯•
  FALLBACK = 'fallback',  // é™çº§
  IGNORE = 'ignore',      // å¿½ç•¥
  STOP = 'stop'          // åœæ­¢
}
```

### 2. âš¡ å…¨é¢æ€§èƒ½ä¼˜åŒ–

æ–°çš„æ€§èƒ½ä¼˜åŒ–ç³»ç»ŸåŒ…å«æ™ºèƒ½æ‰¹å¤„ç†ã€å¿«é€Ÿåºåˆ—åŒ–å’Œå†…å­˜ç®¡ç†ï¼Œæ˜¾è‘—æå‡æ—¥å¿—ç³»ç»Ÿæ€§èƒ½ã€‚

#### æ€§èƒ½æå‡æ•°æ®

- **åºåˆ—åŒ–æ€§èƒ½**: ç¼“å­˜å‘½ä¸­ç‡ 75%ï¼Œååé‡ 148 ops/sec
- **æ‰¹å¤„ç†æ•ˆç‡**: è‡ªé€‚åº”æ‰¹å¤„ç†ï¼Œå‡å°‘ 60% ç½‘ç»œè¯·æ±‚
- **å†…å­˜ä¼˜åŒ–**: æ™ºèƒ½å‹ç¼©ï¼Œå‡å°‘ 30-50% å†…å­˜ä½¿ç”¨

#### æ™ºèƒ½æ‰¹å¤„ç†

```typescript
const logger = await createBrowserLogger({
  outputs: {
    http: {
      enabled: true,
      endpoint: '/api/logs',
      batchSize: 50,              // æ‰¹æ¬¡å¤§å°
      flushInterval: 10000,       // åˆ·æ–°é—´éš”
      adaptive: true              // è‡ªé€‚åº”æ‰¹å¤„ç†
    }
  }
})

// è·å–æ‰¹å¤„ç†ç»Ÿè®¡
const batcher = logger.getBatcher()
const stats = batcher.getStats()
console.log('æ‰¹å¤„ç†æ•ˆç‡:', stats.efficiency)
console.log('å¹³å‡æ‰¹æ¬¡å¤§å°:', stats.averageBatchSize)
```

#### å¿«é€Ÿåºåˆ—åŒ–

```typescript
import { FastSerializer } from 'loglayer/core'

const serializer = new FastSerializer({
  fastMode: true,     // å¿«é€Ÿæ¨¡å¼
  caching: true,      // å¯ç”¨ç¼“å­˜
  cacheSize: 100      // ç¼“å­˜å¤§å°
})

// åºåˆ—åŒ–æ•°æ®
const result = serializer.serialize(data, 'cache-key')

// è·å–åºåˆ—åŒ–ç»Ÿè®¡
const stats = serializer.getStats()
console.log('ç¼“å­˜å‘½ä¸­ç‡:', stats.cacheHitRate)
console.log('å¹³å‡åºåˆ—åŒ–æ—¶é—´:', stats.averageSerializationTime)
```

#### å†…å­˜ç®¡ç†

```typescript
import { MemoryManager } from 'loglayer/core'

const memoryManager = new MemoryManager({
  maxMemoryUsage: 50,    // æœ€å¤§å†…å­˜ä½¿ç”¨ (MB)
  checkInterval: 5000,   // æ£€æŸ¥é—´éš”
  compression: true      // å¯ç”¨å‹ç¼©
})

// å‹ç¼©æ•°æ®
const compressed = memoryManager.compress(largeData)

// è·å–å†…å­˜ç»Ÿè®¡
const stats = memoryManager.getStats()
console.log('å½“å‰å†…å­˜ä½¿ç”¨:', stats.currentUsage)
console.log('å‹ç¼©ç‡:', stats.compressionRatio)
```

### 3. âœ… å…¨é¢é…ç½®éªŒè¯

æ–°çš„é…ç½®éªŒè¯ç³»ç»Ÿæä¾›è¯¦ç»†çš„é”™è¯¯æç¤ºã€æ™ºèƒ½å»ºè®®å’Œåˆ†çº§éªŒè¯ç»“æœã€‚

#### éªŒè¯ç‰¹æ€§

- **ç±»å‹éªŒè¯**: ç¡®ä¿é…ç½®å­—æ®µç±»å‹æ­£ç¡®
- **å€¼èŒƒå›´éªŒè¯**: æ£€æŸ¥æ•°å€¼ã€å­—ç¬¦ä¸²é•¿åº¦ç­‰
- **æšä¸¾éªŒè¯**: éªŒè¯æ—¥å¿—çº§åˆ«ç­‰æšä¸¾å€¼
- **ä¾èµ–å…³ç³»éªŒè¯**: æ£€æŸ¥é…ç½®é—´çš„é€»è¾‘å…³ç³»
- **æ™ºèƒ½å»ºè®®**: æ‹¼å†™é”™è¯¯çº æ­£ã€æœ€ä½³å®è·µæç¤º

#### ä½¿ç”¨ç¤ºä¾‹

```typescript
import { validateBrowserConfig, validateBrowserConfigStrict } from 'loglayer'

// åŸºç¡€éªŒè¯
const config = {
  level: 'info',
  outputs: {
    console: true,
    http: { endpoint: '/api/logs' }
  }
}

const result = validateBrowserConfig(config)
if (!result.valid) {
  console.error('é…ç½®é”™è¯¯:', result.errors)
  console.warn('é…ç½®è­¦å‘Š:', result.warnings)
  console.info('é…ç½®å»ºè®®:', result.suggestions)
}

// ä¸¥æ ¼éªŒè¯ï¼ˆæŠ›å‡ºé”™è¯¯ï¼‰
try {
  validateBrowserConfigStrict(config)
  console.log('é…ç½®éªŒè¯é€šè¿‡')
} catch (error) {
  console.error('é…ç½®éªŒè¯å¤±è´¥:', error.message)
}
```

#### éªŒè¯ç»“æœç¤ºä¾‹

```typescript
// éªŒè¯ç»“æœç»“æ„
interface ValidationResult {
  valid: boolean
  errors: Array<{
    code: string
    message: string
    path: string
    value: any
    severity: 'low' | 'medium' | 'high' | 'critical'
    expected?: string
  }>
  warnings: Array<{
    message: string
    path: string
    value: any
  }>
  suggestions: Array<{
    message: string
    path: string
    suggestedConfig: any
  }>
}
```

## ğŸ”§ è¿ç§»æŒ‡å—

### ä» v0.5.x è¿ç§»

#### 1. æ›´æ–°ä¾èµ–

```bash
npm install loglayer@0.6.0-beta.1
```

#### 2. é…ç½®æ›´æ–°

```typescript
// v0.5.x
const logger = createLogger({
  outputs: ['console', 'http']
})

// v0.6.0-beta.1
const logger = await createBrowserLogger({
  outputs: {
    console: { enabled: true },
    http: { 
      enabled: true,
      endpoint: '/api/logs'
    }
  }
})
```

#### 3. é”™è¯¯å¤„ç†æ›´æ–°

```typescript
// v0.5.x
logger.error('Error occurred', error)

// v0.6.0-beta.1 (æ¨è)
logger.logError(error, { context: 'user-action' })
```

### ç ´åæ€§å˜æ›´

1. **é…ç½®ç»“æ„å˜æ›´**: è¾“å‡ºå™¨é…ç½®ä»æ•°ç»„æ”¹ä¸ºå¯¹è±¡
2. **å¼‚æ­¥åˆ›å»º**: `createBrowserLogger` ç°åœ¨æ˜¯å¼‚æ­¥å‡½æ•°
3. **é”™è¯¯å¤„ç†**: æ–°å¢ä¸“ç”¨çš„ `logError` æ–¹æ³•

### å…¼å®¹æ€§

- **Node.js**: >= 16.0.0
- **æµè§ˆå™¨**: ç°ä»£æµè§ˆå™¨ (ES2020+)
- **TypeScript**: >= 4.5.0

## ğŸ¯ æœ€ä½³å®è·µ

### 1. æ€§èƒ½ä¼˜åŒ–é…ç½®

```typescript
const logger = await createBrowserLogger({
  // ç”Ÿäº§ç¯å¢ƒé…ç½®
  level: 'warn',
  sampling: { rate: 0.1 },
  outputs: {
    http: {
      enabled: true,
      endpoint: '/api/logs',
      batchSize: 100,
      flushInterval: 30000,
      retryAttempts: 3
    }
  }
})
```

### 2. å¼€å‘ç¯å¢ƒé…ç½®

```typescript
const logger = await createBrowserLogger({
  // å¼€å‘ç¯å¢ƒé…ç½®
  level: 'debug',
  outputs: {
    console: {
      enabled: true,
      colorized: true,
      showMetadataTable: true
    }
  },
  errorHandling: {
    captureGlobalErrors: true
  }
})
```

### 3. é”™è¯¯å¤„ç†ç­–ç•¥

```typescript
const logger = await createBrowserLogger({
  errorHandling: {
    captureGlobalErrors: true,
    captureUnhandledRejections: true,
    errorFilter: (error) => {
      // è¿‡æ»¤ç¬¬ä¸‰æ–¹é”™è¯¯
      return !error.stack?.includes('third-party-lib')
    }
  },
  outputs: {
    http: {
      enabled: true,
      endpoint: '/api/logs',
      onError: (error, data) => {
        // é™çº§åˆ°æœ¬åœ°å­˜å‚¨
        localStorage.setItem('failed-logs', JSON.stringify(data))
      }
    }
  }
})
```

## ğŸ“Š æ€§èƒ½åŸºå‡†

### æµ‹è¯•ç¯å¢ƒ

- **CPU**: Intel i7-10700K
- **å†…å­˜**: 32GB DDR4
- **æµè§ˆå™¨**: Chrome 120+

### åŸºå‡†ç»“æœ

| åŠŸèƒ½ | v0.5.x | v0.6.0-beta.1 | æå‡ |
|------|--------|---------------|------|
| åºåˆ—åŒ–é€Ÿåº¦ | 85 ops/sec | 148 ops/sec | +74% |
| æ‰¹å¤„ç†æ•ˆç‡ | 60% | 85% | +42% |
| å†…å­˜ä½¿ç”¨ | 100% | 65% | -35% |
| é”™è¯¯å¤„ç†å»¶è¿Ÿ | 15ms | 8ms | -47% |

## ğŸ”® æœªæ¥è®¡åˆ’

### v0.6.0 æ­£å¼ç‰ˆ

- æ€§èƒ½è¿›ä¸€æ­¥ä¼˜åŒ–
- æ›´å¤šè¾“å‡ºå™¨æ”¯æŒ
- å¢å¼ºçš„é”™è¯¯åˆ†æ

### v0.7.0

- å®æ—¶æ—¥å¿—æµ
- é«˜çº§è¿‡æ»¤å™¨
- æ’ä»¶ç³»ç»Ÿ

## ğŸ› å·²çŸ¥é—®é¢˜

1. **IndexedDB åˆå§‹åŒ–**: åœ¨æŸäº›æµè§ˆå™¨ä¸­å¯èƒ½è¾ƒæ…¢
2. **å¤§æ•°æ®åºåˆ—åŒ–**: è¶…å¤§å¯¹è±¡å¯èƒ½å½±å“æ€§èƒ½
3. **å†…å­˜ç›‘æ§**: åœ¨ Web Worker ä¸­åŠŸèƒ½å—é™

## ğŸ“ æ”¯æŒ

- **GitHub Issues**: [æŠ¥å‘Šé—®é¢˜](https://github.com/loglayer/loglayer/issues)
- **æ–‡æ¡£**: [å®Œæ•´æ–‡æ¡£](https://loglayer.dev)
- **ç¤¾åŒº**: [Discord é¢‘é“](https://discord.gg/loglayer)

---

**æ³¨æ„**: v0.6.0-beta.1 æ˜¯ Beta ç‰ˆæœ¬ï¼Œå»ºè®®åœ¨éç”Ÿäº§ç¯å¢ƒä¸­æµ‹è¯•åå†éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚
